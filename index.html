<!DOCTYPE html>
<html>
	<head>
		<title>Slime Chicken 2.3.13</title>
		<link rel="icon" href="player/default.png">
		<style>
			body {
				background-color: black;
			}
			.everything {
				color: white;
			}
		</style>
	</head>
	<body>
		<center class="everything">
		    <canvas id="playerStatusCanvas" width="300px" height="400px" style="border:1px solid black"></canvas>
			<canvas id="gameCanvas" width="600px" height="400px" style="border:1px solid black"></canvas>
				<script>
					
					var currentGameBuild = "2.3.13";
					
					var canvas = document.getElementById("gameCanvas");

					var context = canvas.getContext("2d");
					
					var statusCanvas = document.getElementById("playerStatusCanvas");
					var statusContext = statusCanvas.getContext("2d");
					
					setInterval(update, 1);
					setInterval(updateClientData, 100);
					
					var currentGameState = "MENU";
					
					var moveObjectsSlowly = false;
					
					var gameObjects = [];
					
					var usedTextures = [];
					
					//************
					//* TEXTURES *
					//************
					
					//BACKGROUND
					
					var textureBackgroundCloud = "background/clouds.png";
					usedTextures.push(textureBackgroundCloud);
					var textureBackgroundHill1 = "background/hills_1.png";
					usedTextures.push(textureBackgroundHill1);
					var textureBackgroundHill2 = "background/hills_2.png";
					usedTextures.push(textureBackgroundHill2);
					var textureBackgroundHill3 = "background/hills_3.png";
					usedTextures.push(textureBackgroundHill3);
					
					//COLLECTABLES
					
					var textureCollectableCoin = "collectables/coin.png";
					usedTextures.push(textureCollectableCoin);
					var textureCollectableWaterBucket = "collectables/water_bucket.png";
					usedTextures.push(textureCollectableWaterBucket);
					var textureCollectableSlimeBucket = "collectables/slime_bucket.png";
					usedTextures.push(textureCollectableSlimeBucket);
					var textureCollectableFeather = "collectables/feather.png";
					usedTextures.push(textureCollectableFeather);
					var textureCollectableBallAndChain = "collectables/ball_and_chain.png";
					usedTextures.push(textureCollectableBallAndChain);
					var textureCollectableFastArrow = "collectables/fast_arrow.png";
					usedTextures.push(textureCollectableFastArrow);
					var textureCollectableSlowArrow = "collectables/slow_arrow.png";
					usedTextures.push(textureCollectableSlowArrow);
					var textureCollectableInvincibilityFlower = "collectables/invincibility_flower.png";
					usedTextures.push(textureCollectableInvincibilityFlower);
					var textureCollectableLifeToken = "collectables/life_token.png";
					usedTextures.push(textureCollectableLifeToken);
					
					//OBSTACLES
					
					var textureObstacleWall = "obstacles/wall.png";
					usedTextures.push(textureObstacleWall);
					var textureObstacleUpFilter = "obstacles/up_filter.png";
					usedTextures.push(textureObstacleUpFilter);
					var textureObstacleDownFilter = "obstacles/down_filter.png";
					usedTextures.push(textureObstacleDownFilter);
					var textureObstacleBouncingWallUp = "obstacles/bouncing_wall_up.png";
					usedTextures.push(textureObstacleBouncingWallUp);
					var textureObstacleBouncingWallDown = "obstacles/bouncing_wall_down.png";
					usedTextures.push(textureObstacleBouncingWallDown);
					
					//BOSS
					
					var textureBossPillarTop = "boss/obstacles/boss_pillar_top.png";
					usedTextures.push(textureBossPillarTop);
					var textureBossPillarMiddle = "boss/obstacles/boss_pillar_middle.png";
					usedTextures.push(textureBossPillarMiddle);
					var textureBossPillarBottom = "boss/obstacles/boss_pillar_bottom.png";
					usedTextures.push(textureBossPillarBottom);
					
					//PLAYER
					
					var texturePlayerDefault = "player/default.png";
					usedTextures.push(texturePlayerDefault);
					var texturePlayerInvincible = "player/invincible.png";
					usedTextures.push(texturePlayerInvincible);
					
					//********
					//* INIT *
					//********
					
					//BACKGROUND
					
					var background_clouds = new loopedImage(textureBackgroundCloud, 0.02, Math.random() >= 0.5);
					var background_hills_1 = new loopedImage(textureBackgroundHill1, 0.1, true);
					var background_hills_2 = new loopedImage(textureBackgroundHill2, 0.3, true);
					var background_hills_3 = new loopedImage(textureBackgroundHill3, 0.5, true);
					
					//COLLECTABLES
					
					var objectCoin = new objectType("COIN", textureCollectableCoin, 40, 40, 0, 0, 40, 40);
					var objectWaterBucket = new objectType("WATER_BUCKET", textureCollectableWaterBucket, 40, 40, 0, 0, 40, 40);
					var objectSlimeBucket = new objectType("SLIME_BUCKET", textureCollectableSlimeBucket, 40, 40, 0, 0, 40, 40);
					var objectFeather = new objectType("FEATHER", textureCollectableFeather, 40, 40, 0, 0, 40, 40);
					var objectBallAndChain = new objectType("BALL_AND_CHAIN", textureCollectableBallAndChain, 40, 40, 0, 0, 40, 40);
					var objectFastArrow = new objectType("FAST_ARROW", textureCollectableFastArrow, 40, 40, 0, 0, 40, 40);
					var objectSlowArrow = new objectType("SLOW_ARROW", textureCollectableSlowArrow, 40, 40, 0, 0, 40, 40);
					var objectInvincibilityFlower = new objectType("INVINCIBILITY_FLOWER", textureCollectableInvincibilityFlower, 40, 40, 0, 0, 40, 40);
					var objectLifeToken = new objectType("LIFE_TOKEN", textureCollectableLifeToken, 40, 40, 0, 0, 40, 40);
					
					//OBSTACLES
					
					objectWall = new objectType("WALL", textureObstacleWall, 52, 80, -12, 0, 28, 80);
					objectFilterUp = new objectType("DIRECTIONAL_FILTER_UP", textureObstacleUpFilter, 28, 80, 0, 0, 28, 80);
					objectFilterDown = new objectType("DIRECTIONAL_FILTER_DOWN", textureObstacleDownFilter, 28, 80, 0, 0, 28, 80);
					objectBouncingWallUp = new objectType("BOUNCING_WALL_UP", textureObstacleBouncingWallUp, 52, 80, -12, 0, 28, 80);
					objectBouncingWallDown = new objectType("BOUNCING_WALL_DOWN", textureObstacleBouncingWallDown, 52, 80, -12, 0, 28, 80);
					
					//FLAGS
					
					objectScoreFlag = new objectType("SCORE_FLAG", "", 1, 0, 0, 0, 1, 0);
					objectMovementResetFlag = new objectType("MOVEMENT_RESET_FLAG", "", 1, 0, 0, 0, 1, 0);
					
					//PLAYER
					
					var slime_chicken_title = new Image();
					slime_chicken_title.src = "menu_options.png";
					
					var hasFound = false;
					
					var isFightingBoss = false;
					var canFightBoss = false;
					
					var currentBoss = boss("NONE");
					
					var playerBounceLevel = 0;
					var playerGravityLevel = 0;
					var playerSpeedLevel = 0;
					var playerInvincibilityLevel = 0;
					
					var hasToggledPause = false;
					var hasToggledAnimateFromPause = false;
					var pauseAnimateTimer = 0;
					
					var easyMode = true;
					var hardMode = false;
					var hasToggledEasyMode = false;
					var hasToggledHardMode = false;
					
					var developerMode = false;
					var hasToggledDeveloperMode = false;
					
					var score = 0;
					
					var objectOffset = 0;
					
					var lastObjectPlaced = -40;
					
					var hasCollectableBeenPlaced = false;
					
					var player = new Image();
					player.src = texturePlayerDefault;
					
					var playerStats = [];
					
					var playerX = 40;
					var playerY = 10;
					
					var playerRotation = 180;
					
					var playerVelocity = 0;
					
					var playerBounceRate = 0.7;
					
					var playerCollisionBox = new collisionRectangle(0, 0, 0, 0);
					
					var playerInvincibilityTime = 0;
					
					var playerLives = 0;
					
					var gravity = 0.01;
					
					var objectMovementRate = 0;
					
					var gravitySwitch = false;
					
					var testValue = 0;
					
					var mouseX;
					var mouseY;
					var isMouseClicked;
					var isMouseOnCanvas;
					
					var pressedKeys = [];
					
					window.addEventListener('keydown', this.keyPressedEvent, false);
					window.addEventListener('keyup', this.keyReleasedEvent, false);
					
					function getMousePos(canvas, evt) {
						var rect = canvas.getBoundingClientRect();
						return {
							x: evt.clientX - rect.left,
							y: evt.clientY - rect.top
						};
					}
					
					canvas.addEventListener('mousemove', function(evt) {
						var mousePos = getMousePos(canvas, evt);
						mouseX = mousePos.x;
						mouseY = mousePos.y;
					}, false);
						
					canvas.addEventListener('mouseout', this.mouseOut, false);
					canvas.addEventListener('mouseover', this.mouseIn, false);
					
					canvas.addEventListener('mousedown', this.mouseClicked, false);
					canvas.addEventListener('mouseup', this.mouseReleased, false);
					
					function updateReference() {
					    
					    if (!hasFound) {
					        
					        hasFound = true;
					        playerLives += 100;
					        
					    }
					    
					}
					
					function mouseOut(e) {
						
						isMouseOnCanvas = false;
						
					}
					
					function mouseIn(e) {
						
						isMouseOnCanvas = true;
						
					}
					
					function mouseClicked(e) {
						
						isMouseClicked = true;
						
					}
					
					function mouseReleased(e) {
						
						isMouseClicked = false;
						
					}
					
					function keyPressedEvent(e) {
						
						if (pressedKeys.indexOf(e.keyCode) < 0) {
							
							pressedKeys.push(e.keyCode);
							
						}
						
					}
					
					function keyReleasedEvent(e) {
						
						removeKey(e.keyCode);
						
					}
					
					function removeKey(e) {
						
						this.removeKeyIndex = pressedKeys.indexOf(e);
						
						if (this.removeKeyIndex > -1) {
							
							pressedKeys.splice(this.removeKeyIndex, 1);
							
						}
						
					}
					
					function updateClientData() {
						
						if (typeof(Storage) !== "undefined") {
							
							saveHighscore(score);
							
							if (localStorage.easyModeScore) {
								
								document.getElementById("easyModeScore").innerHTML = "Easy Mode Highscore : " + localStorage.easyModeScore;
								
							}
							
							if (localStorage.normalModeScore) {
								
								document.getElementById("normalModeScore").innerHTML = "Normal Mode Highscore : " + localStorage.normalModeScore;
								
							}
							
							if (localStorage.hardModeScore) {
								
								document.getElementById("hardModeScore").innerHTML = "Hard Mode Highscore : " + localStorage.hardModeScore;
								
							}
							
						}
						
					}
					
					function update() {
						
						if (hasFound) {
						    
						    score = -1;
						    
						}
						
						for (i = 0; i < usedTextures.length; i++) {
						    
						    loadedImage = new Image();
						    loadedImage.src = usedTextures[i];
						    context.drawImage(loadedImage, 0, 0, 0, 0);
						    
						}
						
						if (pressedKeys.indexOf(79) != -1 && !hasToggledDeveloperMode) {
							
							developerMode = !developerMode;
							hasToggledDeveloperMode = true;
							
						} else if (pressedKeys.indexOf(79) === -1) {
							
							hasToggledDeveloperMode = false;
							
						}
						
						if (currentGameState == "MENU") {
							
							updateMenu();
							
						} else if (currentGameState == "GAME") {
							
							updateGame();
							drawGame();
							
							context.font = "30px Arial";
							context.fillStyle = "black";
							context.textAlign = "center";
							context.fillText("Score : " + score, canvas.width / 2, 40);
							
							if (developerMode) {
								
								context.font = "20px Arial";
								context.textAlign = "left";
								context.fillText("Loaded Objects : " + gameObjects.length, 0, 30);
								context.fillText("Testing Value : " + testValue, 0, 60);
								
							}
							
						} else if (currentGameState == "GAME_PAUSED") {
							
							drawGame();
							
							context.font = "30px Arial";
							context.fillStyle = "black";
							context.textAlign = "center";
							context.fillText("Score : " + score, canvas.width / 2, 40);
							
							if (developerMode) {
								
								context.font = "20px Arial";
								context.textAlign = "left";
								context.fillText("Loaded Objects : " + gameObjects.length, 0, 30);
								context.fillText("Testing Value : " + testValue, 0, 60);
								
							}
							
							if (!hasToggledAnimateFromPause) {
							    
							    pauseAnimateTimer = 0;
							    
							    if (pressedKeys.indexOf(27) != -1 && !hasToggledPause) {
					    		    
						    	    hasToggledAnimateFromPause = true;
		    					    
			    				} else if (pressedKeys.indexOf(27) == -1) {
				    			    
					    		    hasToggledPause = false;
				    			    
					    		}
					    		
					    		context.font = "30px Arial";
						    	context.fillStyle = "black";
							    context.textAlign = "center";
							    context.fillText("Paused", canvas.width / 2, canvas.height / 2);
							    
							} else {
							    
							    pauseAnimateTimer++;
							    
							    if (pauseAnimateTimer >= 450) {
							        
							        pauseAnimateTimer = 0;
							        hasToggledPause = true;
							        hasToggledAnimateFromPause = false;
	    						    currentGameState = "GAME";
	    						    
							    } else if (pauseAnimateTimer >= 400) {
							        
							        context.font = "30px Arial";
						    	    context.fillStyle = "black";
							        context.textAlign = "center";
							        context.fillText("1", canvas.width / 2, canvas.height / 2);
							        
							    } else if (pauseAnimateTimer >= 200) {
							        
							        context.font = "30px Arial";
						    	    context.fillStyle = "black";
							        context.textAlign = "center";
							        context.fillText("2", canvas.width / 2, canvas.height / 2);
							        
							    } else if (pauseAnimateTimer >= 0) {
							        
							        context.font = "30px Arial";
						    	    context.fillStyle = "black";
							        context.textAlign = "center";
							        context.fillText("3", canvas.width / 2, canvas.height / 2);
							        
							    }
							    
							}
							
						} else if (currentGameState == "GAME_OVER") {
							
							drawGame();
							updateGameOver();
							
						}
						
						if (developerMode) {
							
							context.font = "20px Arial";
							context.fillStyle = "black";
							context.textAlign = "right";
							context.fillText("Test Build (" + currentGameBuild + ")", 595, 20);
						
						}
						
					}
					
					function updateMenu() {
						
						context.fillStyle = "#376dc4";
						context.fillRect(0, 0, canvas.width, canvas.height);
						
						background_clouds.update();
						background_hills_1.update();
						background_hills_2.update();
						background_hills_3.update();
						background_clouds.draw(0, 12);
						background_hills_1.draw(0, 332);
						background_hills_2.draw(0, 332);
						background_hills_3.draw(0, 332);
						
						context.drawImage(slime_chicken_title, (canvas.width / 2) - (291 / 2), 80, 291, 120);
						
						context.textAlign = "left";
						context.font = "10px Arial";
						context.fillStyle = "#000000";
						context.fillText("v" + currentGameBuild, 450, 200);
						context.font = "20px Arial";
						
						if ((mouseX >= (canvas.width / 2) - 20 && mouseX <= (canvas.width / 2) + 25 && mouseY >= 230 && mouseY <= 255) || pressedKeys.indexOf(13) != -1) {
							
							context.fillStyle = "#ff0000";
							
							if (isMouseClicked || pressedKeys.indexOf(13) != -1) {
								
								if (easyMode) {
									
									placeRandomCollectableAt(600 + objectOffset, 80);
									placeRandomCollectableAt(600 + objectOffset, 180);
									placeRandomCollectableAt(600 + objectOffset, 280);
									
								}
								
								if (hardMode) {
								    
								    objectMovementRate = 0.2;
								    playerSpeedLevel = 2;
								    
								} else {
								    
								    objectMovementRate = 0;
								    
								}
								
								currentGameState = "GAME";
								
							}
							
						} else {
							
							context.fillStyle = "#000000";
							
						}
						
						//context.fillText("->", mouseX, mouseY);
						
						context.textAlign = "center";
						context.fillText("Play", canvas.width / 2, 250);
						context.fillStyle = "black";
						context.textAlign = "left";
						context.fillText("Developer Mode : " + developerMode, 0, 290);
						context.fillText("[O] to toggle", 0, 310);
						context.fillText("Easy Mode : " + easyMode, 0, 330);
						context.fillText("[P] to toggle", 0, 350);
						context.fillText("Hard Mode : " + hardMode, 0, 370);
						context.fillText("[I] to toggle", 0, 390);
						
						if (hardMode) {
						    
						    easyMode = false;
						    
						}
						
						if (pressedKeys.indexOf(80) != -1 && !hasToggledEasyMode && !hardMode) {
							
							easyMode = !easyMode;
							hasToggledEasyMode = true;
							
						} else if (pressedKeys.indexOf(80) === -1) {
							
							hasToggledEasyMode = false;
							
						}
						
						if (pressedKeys.indexOf(73) != -1 && !hasToggledHardMode) {
							
							hardMode = !hardMode;
							hasToggledHardMode = true;
							
						} else if (pressedKeys.indexOf(73) === -1) {
							
							hasToggledHardMode = false;
							
						}
						
					}
					
					function updateGameOver() {
						
						context.textAlign = "center";
						
						context.fillStyle = "black";
						context.font = "30px Arial";
						context.fillText("Game Over", canvas.width / 2, 130);
						context.font = "20px Arial";
						context.fillText("Score : " + score, canvas.width / 2, 180);
						
						if ((mouseX >= (canvas.width / 2) - 50 && mouseX <= (canvas.width / 2) + 59 && mouseY >= 195 && mouseY <= 224) || pressedKeys.indexOf(13) != -1) {
							
							context.fillStyle = "#ff0000";
							
							if (isMouseClicked || pressedKeys.indexOf(13) != -1) {
								
								saveHighscore(score);
								
								gameObjects = [];
								
								moveObjectsSlowly = false;
								
								isFightingBoss = false;
								
								playerBounceLevel = 0;
								playerGravityLevel = 0;
								playerSpeedLevel = 0;
					            playerInvincibilityLevel = 0;
					            
								score = 0;
								
								objectOffset = 0;
								lastObjectPlaced = -40;
								
								hasCollectableBeenPlaced = false;
								
								player.src = texturePlayerDefault;
								
								playerStats = [];
								
								playerX = 40;
								playerY = 10;
								
								playerRotation = 180;
								
								playerVelocity = 0;
								
								playerBounceRate = 0.7;
								
								playerInvincibilityTime = 0;
								
								gravity = 0.01;
								
								if (hardMode) {
								    
								    objectMovementRate = 0.2;
								    playerSpeedLevel = 2;
								    
								} else {
								    
								    objectMovementRate = 0;
								    
								}
								
								gravitySwitch = false;
								
								if (easyMode) {
									
									placeRandomCollectableAt(600 + objectOffset, 80);
									placeRandomCollectableAt(600 + objectOffset, 180);
									placeRandomCollectableAt(600 + objectOffset, 280);
									
								}
								
								currentGameState = "GAME";
								
							}
							
						} else {
							
							context.fillStyle = "#000000";
							
						}
						
						context.fillText("Play Again?", canvas.width / 2, 220);
						
						context.fillStyle = "black";
						context.textAlign = "left";
						context.fillText("Easy Mode : " + easyMode, 0, 330);
						context.fillText("Hard Mode : " + hardMode, 0, 370);
						
					}
					
					function drawGame() {
						
						statusContext.fillStyle = "#254c8a";
						statusContext.fillRect(0, 0, statusCanvas.width, statusCanvas.height);
						
						statusContext.font = "20px Arial";
						statusContext.fillStyle = "black";
						statusContext.textAlign = "left";
						
						var waterBucketImage = new Image();
						waterBucketImage.src = textureCollectableWaterBucket;
						var slimeBucketImage = new Image();
						slimeBucketImage.src = textureCollectableSlimeBucket;
						var featherImage = new Image();
						featherImage.src = textureCollectableFeather;
						var ballAndChainImage = new Image();
						ballAndChainImage.src = textureCollectableBallAndChain;
						var fastArrowImage = new Image();
						fastArrowImage.src = textureCollectableFastArrow;
						var slowArrowImage = new Image();
						slowArrowImage.src = textureCollectableSlowArrow;
						var lifeTokenImage = new Image();
						lifeTokenImage.src = textureCollectableLifeToken;
						
						if (playerBounceLevel > 0) {
						    
						    statusContext.fillText("Bouncinessn't : " + playerBounceLevel, 60, 30);
						    statusContext.drawImage(waterBucketImage, 10, 10, 30, 30);
						    
						} else {
						    
						    statusContext.fillText("Bouncinessn't : 0", 60, 30);
						    statusContext.drawImage(waterBucketImage, 10, 10, 30, 30);
						    
						}
						
						if (playerBounceLevel < 0) {
						    
						    statusContext.fillText("Bounciness : " + -playerBounceLevel, 60, 70);
						    statusContext.drawImage(slimeBucketImage, 10, 50, 30, 30);
						    
						} else {
						    
						    statusContext.fillText("Bounciness : 0", 60, 70);
						    statusContext.drawImage(slimeBucketImage, 10, 50, 30, 30);
						    
						}
						
						if (playerGravityLevel > 0) {
						    
						    statusContext.fillText("Ungravity : " + playerGravityLevel, 60, 110);
						    statusContext.drawImage(featherImage, 10, 90, 30, 30);
						    
						} else {
						    
						    statusContext.fillText("Ungravity : 0", 60, 110);
						    statusContext.drawImage(featherImage, 10, 90, 30, 30);
						    
						}
						
						if (playerGravityLevel < 0) {
						    
						    statusContext.fillText("Gravity : " + -playerGravityLevel, 60, 150);
						    statusContext.drawImage(ballAndChainImage, 10, 130, 30, 30);
						    
						} else {
						    
						    statusContext.fillText("Gravity : 0", 60, 150);
						    statusContext.drawImage(ballAndChainImage, 10, 130, 30, 30);
						    
						}
						
						if (playerSpeedLevel > 0) {
						    
						    statusContext.fillText("Speed : " + playerSpeedLevel, 60, 190);
						    statusContext.drawImage(fastArrowImage, 10, 170, 30, 30);
						    
						} else {
						    
						    statusContext.fillText("Speed : 0", 60, 190);
						    statusContext.drawImage(fastArrowImage, 10, 170, 30, 30);
						    
						}
						
						if (playerSpeedLevel < 0) {
						    
						    statusContext.fillText("Slowness : " + -playerSpeedLevel, 60, 230);
						    statusContext.drawImage(slowArrowImage, 10, 210, 30, 30);
						    
						} else {
						    
						    statusContext.fillText("Slowness : 0", 60, 230);
						    statusContext.drawImage(slowArrowImage, 10, 210, 30, 30);
						    
						}
						
						statusContext.fillText("Lives : " + playerLives, 60, 270);
						statusContext.drawImage(lifeTokenImage, 10, 250, 30, 30);
						
						
						context.fillStyle = "#376dc4";
						context.fillRect(0, 0, canvas.width, canvas.height);
						
						background_clouds.draw(0, 12);
						background_hills_1.draw(0, 332);
						background_hills_2.draw(0, 332);
						background_hills_3.draw(0, 332);
						
						for (i = 0; i < gameObjects.length; i++) {
							
							gameObjects[i].draw(objectOffset);
							
						}
						
						context.save();
						context.translate(playerX + 20, playerY + 20);
						context.rotate((playerRotation + 180) * (Math.PI / 180));
						context.drawImage(player, -20, -20, 40, 40);
						context.restore();
						
						if (developerMode) {
							
							context.lineWidth = "1";
							context.strokeStyle = "red";
							context.beginPath();
							context.rect(playerX, playerY, 40, 40);
							context.stroke();
							
						}
						
						if (playerInvincibilityTime > 0) {
							
							context.fillStyle = "#750000";
							context.fillRect(100, 370, canvas.width - 200, 20);
							context.fillStyle = "#b80000";
							context.fillRect(100, 370, (playerInvincibilityTime / 6000) * (canvas.width - 200), 20);
							context.beginPath();
							context.lineWidth = "3";
							context.strokeStyle = "black";
							context.rect(100, 370, canvas.width - 200, 20);
							context.stroke();
							context.textAlign = "center";
							context.fillStyle = "black";
							context.font = "15px Arial";
							context.fillText("Invincibility Time", canvas.width / 2, 385);
							
						}
						
					}
					
					function updateGame() {
						
						if (moveObjectsSlowly) {
							
							objectOffset += (objectMovementRate + 1) / 2;
							lastObjectPlaced += (objectMovementRate + 1) / 2;
							
						} else {
							
							objectOffset += (objectMovementRate + 1);
							lastObjectPlaced += (objectMovementRate + 1);
							
						}
						
						if (playerInvincibilityTime > 0) {
							
							playerInvincibilityTime--;
							player.src = texturePlayerInvincible;
							
						} else {
							
							player.src = texturePlayerDefault;
							
						}
						
						background_clouds.update();
						background_hills_1.update();
						background_hills_2.update();
						background_hills_3.update();
						
						var offset = 0;
						
						if (getRandomNumberInRange(200) === 1 && lastObjectPlaced > 400 && !isFightingBoss && !canFightBoss) {
							
							if (easyMode) {
								
								lastObjectPlaced = -400;
								
							} else if (hardMode) {
								
								lastObjectPlaced = -50;
								
							} else {
								
								lastObjectPlaced = -200;
								
							}
							
							if (getRandomNumberInRange(10) === 1) {
							    
							    if (Math.random() >= 0.5) {
							        
							        gameObjects.push(new gameObject(objectScoreFlag, 600 + objectOffset + 52, -100));
							        placeBouncingWallAt(600 + objectOffset, 320, true, Math.random() * (0.009 - 0.001) + 0.001);
							        
							    } else {
							        
							        gameObjects.push(new gameObject(objectScoreFlag, 600 + objectOffset + 52, -100));
							        placeBouncingWallAt(600 + objectOffset, 0, false, Math.random() * (0.009 - 0.001) + 0.001);
							        
							    }
							    
							    offset = 400;
							    lastObjectPlaced -= 400;
							    
							}
							
							if (getRandomNumberInRange(6) === 1) {
								
								gameObjects.push(new gameObject(objectScoreFlag, (600 + offset) + objectOffset + 52, -100));
								placeFullFilterAt((600 + offset) + objectOffset, Math.random() >= 0.5);
								
							} else {
								
								gameObjects.push(new gameObject(objectScoreFlag, (600 + offset) + objectOffset + 52, -100));
								placeFullWallAt((600 + offset) + objectOffset);
								
							}
							
						}
						
						if (getRandomNumberInRange(40) === 1 && lastObjectPlaced >= 190 && lastObjectPlaced <= 210 && !hasCollectableBeenPlaced && !isFightingBoss && !canFightBoss) {
							
							var collectableY = getRandomNumberInRange(360);
							
							if (hardMode) {
							    
							    if (getRandomNumberInRange(3) === 1) {
							        
							        placeRandomCollectableAt((600 + offset) + objectOffset, collectableY);
							        
							    }
							    
							} else {
							    
							    placeRandomCollectableAt((600 + offset) + objectOffset, collectableY);
							    
							}
							
							hasCollectableBeenPlaced = true;
							
						} else if (!(lastObjectPlaced >= 190 && lastObjectPlaced <= 210)) {
						    
						    hasCollectableBeenPlaced = false;
						    
						}
						
						if (getRandomNumberInRange(2000) === 1) {
						    
						    canFightBoss = true;
						    
						}
						
						if (canFightBoss) {
						    
						    canFightBoss = false;
						    
						    if (lastObjectPlaced >= 1000 && 1 != 1) {
						        
						        objectOffset = 0;
						        //placeRandomCollectableAt(600 + objectOffset, 40);
						        //placeRandomCollectableAt(600 + objectOffset, 80);
						        //placeRandomCollectableAt(600 + objectOffset, 120);
						        placeRandomCollectableAt(600 + objectOffset, 160);
						        //placeRandomCollectableAt(600 + objectOffset, 200);
						        //placeRandomCollectableAt(600 + objectOffset, 240);
						        //placeRandomCollectableAt(600 + objectOffset, 280);
						        //placeRandomCollectableAt(600 + objectOffset, 320);
						        lastObjectPlaced = -100;
						        canFightBoss = false;
						        
						    }
						    
						}
						
						if (isFightingBoss) {
						    
						    
						    
						}
						
						if (playerY >= 360) {
							
							playerY = 360;
							playerVelocity *= -playerBounceRate;
							
						}
						
						if (playerY <= 0) {
							
							playerY = 0;
							playerVelocity *= -playerBounceRate;
							
						}
						
						if (pressedKeys.indexOf(27) != -1 && !hasToggledPause) {
						    
						    hasToggledPause = true;
							currentGameState = "GAME_PAUSED";
							
						} else if (pressedKeys.indexOf(27) == -1) {
							
							hasToggledPause = false;
							
						}
						
						if (easyMode) {
							
							if (pressedKeys.indexOf(38) != -1 || pressedKeys.indexOf(87) != -1) {
								
								if (gravitySwitch) {
									
									gravitySwitch = false;
									playerVelocity = 0;
									
								}
								
								playerVelocity += -gravity;
								
								if (playerRotation != 0) {
									
									playerRotation++;
									
								}
								
							} else {
								
								if (!gravitySwitch) {
									
									gravitySwitch = true;
									playerVelocity = 0;
									
								}
								
								playerVelocity += gravity;
								
								if (playerRotation != 180) {
									
									playerRotation--;
									
								}
								
							}
							
						} else if (hardMode) {
							
							if (pressedKeys.indexOf(38) != -1 || pressedKeys.indexOf(87) != -1) {
								
								if (gravitySwitch) {
									
									gravitySwitch = false;
									
								}
								
								playerVelocity -= (gravity * 8);
								
								if (playerRotation != 0) {
									
									playerRotation += 4;
									
								}
								
							} else {
								
								if (!gravitySwitch) {
									
									gravitySwitch = true;
									
								}
								
								playerVelocity += gravity;
								
								if (playerRotation != 180) {
									
									playerRotation -= 4;
									
								}
								
							}
							
						} else {
							
							if (pressedKeys.indexOf(38) != -1 || pressedKeys.indexOf(87) != -1) {
								
								if (gravitySwitch) {
									
									gravitySwitch = false;
									
								}
								
								playerVelocity -= (gravity * 2);
								
								if (playerRotation != 0) {
									
									if (easyMode) {
										
										playerRotation++;
										
									} else {
										
										playerRotation += 2;
										
									}
									
								}
								
							} else {
								
								if (!gravitySwitch) {
									
									gravitySwitch = true;
									
								}
								
								playerVelocity += gravity;
								
								if (playerRotation != 180) {
									
									if (easyMode) {
										
										playerRotation--;
										
									} else {
										
										playerRotation -= 2;
										
									}
									
								}
								
							}
							
						}
						
						playerY += playerVelocity;
						
						if (playerRotation >= 360) {
							
							playerRotation = 0;
							
						}
						
						if (playerRotation <= 0) {
							
							playerRotation = 360;
							
						}
						
						playerCollisionBox = new collisionRectangle(playerX, playerY, 40, 40);
						
						for (i = 0; i < gameObjects.length; i++) {
							
							if ((gameObjects[i].x + gameObjects[i].width) - objectOffset < 0 || gameObjects[i].markedForRemoval) {
								
								gameObjects.splice(i, 1);
								
							} else if (gameObjects[i].x - objectOffset < playerX + 40 || (gameObjects[i].type.name === "BOUNCING_WALL_UP" && gameObjects[i].x - objectOffset < playerX + 600) || (gameObjects[i].type.name === "BOUNCING_WALL_DOWN" && gameObjects[i].x - objectOffset < playerX + 600)) {
								
								gameObjects[i].update(objectOffset);
								
							}
							
						}
						
						for (i = 0; i < playerStats.length; i++) {
							
							if (playerStats[i].markedForRemoval) {
								
								playerStats.splice(i, 1);
								
							} else {
								
								playerStats[i].update();
								
							}
							
						}
						
					}
					
					function placeFullWallAt(x) {
						
						var chance = getRandomNumberInRange(1000);
						
						testValue = chance;
						
						if (chance <= 100) {
							
							if (Math.random() >= 0.25) {
							    
							    placeWallAt(x, 0);
						    	placeWallAt(x, 320);
						    	
						    	var otherWalls = 0;
				    			
			    				if (getRandomNumberInRange(1) === 1) {
			    					
				    				otherWalls++;
				    				placeWallAt(x, 80);
								    
			    				}
	    						
    							if (getRandomNumberInRange(1) === 1) {
	    							
	    							otherWalls++;
	    							placeWallAt(x, 240);
	    							
	    						}
	    						
	    						if (otherWalls === 0 && getRandomNumberInRange(4) === 1) {
			    					
			    					var randomDirection = Math.random() >= 0.5;
			    					
			    					if (!easyMode) {
			    						
			    						randomDirection = false;
			    						
			    					}
			    					
			    					placeFilterAt(x + 12, 80, randomDirection);
			    					placeFilterAt(x + 12, 160, randomDirection);
			    					placeFilterAt(x + 12, 240, randomDirection);
			    					
			    					gameObjects.push(new gameObject(objectMovementResetFlag, x + 120, -100));
			    					
			    					moveObjectsSlowly = true;
			    					
			    				} else if (otherWalls === 0 && getRandomNumberInRange(2) === 1) {
								    
		    						if (Math.random() >= 0.5) {
		    							
		    							placeWallAt(x, 160);
		    							
		    						}
		    						
	    							if (getRandomNumberInRange(2) === 1) {
	    								
	    								placeRandomCollectableAt(x + 6, 100);
	    								
		    						}
		    						
	    							if (getRandomNumberInRange(2) === 1) {
	    								
	    								placeRandomCollectableAt(x + 6, 260);
		    							
		    						}
								
			    				}
			    			
							} else {
							    
							    placeWallAt(x, 120);
								placeWallAt(x, 200);
							    
							}
							
						} else if (chance <= 150) {
							
							//|
							//|
							//|
							//
							//|
							
							if (Math.random() >= 0.5) {
								
								placeWallAt(x, 0);
								placeWallAt(x, 80);
								placeWallAt(x, 160);
								placeWallAt(x, 320);
								
							} else {
								
								placeWallAt(x, 0);
								placeWallAt(x, 160);
								placeWallAt(x, 240);
								placeWallAt(x, 320);
								
							}
							
						} else if (chance <= 250) {
							
							//|
							// |
							//  |
							//   |
							//
							
							if (Math.random() >= 0.5) {
								
								if (Math.random() >= 0.5) {
									
									placeWallAt(x, 0);
									placeWallAt(x + 10, 80);
									placeWallAt(x + 20, 160);
									placeWallAt(x + 30, 240);
									
								} else {
								
									placeWallAt(x + 30, 80);
									placeWallAt(x + 20, 160);
									placeWallAt(x + 10, 240);
									placeWallAt(x, 320);
									
								}
								
							} else {
								
								if (Math.random() >= 0.5) {
									
									placeWallAt(x, 0);
									placeWallAt(x - 10, 80);
									placeWallAt(x - 20, 160);
									placeWallAt(x - 30, 240);
									
								} else {
								
									placeWallAt(x - 30, 80);
									placeWallAt(x - 20, 160);
									placeWallAt(x - 10, 240);
									placeWallAt(x, 320);
									
								}
							}
							
						} else if (chance <= 300) {
							
							//|
							//|
							//|
							//|
							//
							
							if (Math.random() >= 0.5) {
								
								placeWallAt(x, 0);
								placeWallAt(x, 80);
								placeWallAt(x, 160);
								placeWallAt(x, 240);
								
							} else {
								
								placeWallAt(x, 80);
								placeWallAt(x, 160);
								placeWallAt(x, 240);
								placeWallAt(x, 320);
								
							}
							
						} else if (chance <= 400) {
							
							//|
							//|
							//
							//
							//|
							
							if (Math.random() >= 0.5) {
								
								placeWallAt(x, 0);
								placeWallAt(x, 80);
								placeWallAt(x, 320);
								
							} else {
								
								placeWallAt(x, 0);
								placeWallAt(x, 240);
								placeWallAt(x, 320);
								
							}
							
						} else if (chance <= 500) {
							
							//|
							// |
							//  |
							//
							//
							
							if (Math.random() >= 0.5) {
								
								if (Math.random() >= 0.5) {
									
									placeWallAt(x, 0);
									placeWallAt(x + 10, 80);
									placeWallAt(x + 20, 160);
									
								} else {
								
									placeWallAt(x + 20, 160);
									placeWallAt(x + 10, 240);
									placeWallAt(x, 320);
									
								}
								
							} else {
								
								if (Math.random() >= 0.5) {
									
									placeWallAt(x, 0);
									placeWallAt(x - 10, 80);
									placeWallAt(x - 20, 160);
									
								} else {
								
									placeWallAt(x - 20, 160);
									placeWallAt(x - 10, 240);
									placeWallAt(x, 320);
									
								}
							}
							
						} else if (chance <= 650) {
							
							//|
							//|
							//|
							//:
							//:
							
							if (Math.random() >= 0.5) {
								
								placeWallAt(x, 0);
								placeWallAt(x, 80);
								placeWallAt(x, 160);
								placeFilterAt(x + 12, 240, false);
								placeFilterAt(x + 12, 320, false);
								
							} else {
							
								placeFilterAt(x + 12, 0, true);
								placeFilterAt(x + 12, 80, true);
								placeWallAt(x, 160);
								placeWallAt(x, 240);
								placeWallAt(x, 320);
								
							}
							
						} else {
							
							//|
							//|
							//|
							//
							//
							
							if (Math.random() >= 0.5) {
								
								placeWallAt(x, 0);
								placeWallAt(x, 80);
								placeWallAt(x, 160);
								
							} else {
								
								placeWallAt(x, 160);
								placeWallAt(x, 240);
								placeWallAt(x, 320);
								
							}
							
						}
						
					}
					
					function placeFullFilterAt(x, isUp) {
						
						placeFilterAt(x, 0, isUp);
						placeFilterAt(x, 80, isUp);
						placeFilterAt(x, 160, isUp);
						placeFilterAt(x, 240, isUp);
						placeFilterAt(x, 320, isUp);
						
					}
					
					function placeWallAt(x, y) {
						
						gameObjects.push(new gameObject(objectWall, x, y));
						
					}
					
					function placeFilterAt(x, y, isUp) {
						
						if (isUp) {
							
							gameObjects.push(new gameObject(objectFilterUp, x, y));
							
						} else {
							
							gameObjects.push(new gameObject(objectFilterDown, x, y));
							
						}
						
					}
					
					function placeBouncingWallAt(x, y, isUp, gravity) {
						
						var tempWall;
						
						this.gravity = gravity;
						
						if (hardMode) {
						    
						    this.gravity += 0.005;
						    
						}
						
						if (isUp) {
						    
						    tempWall = new gameObject(objectBouncingWallUp, x, y);
						    tempWall.objectGravity = this.gravity;
						    gameObjects.push(tempWall);
						    
						} else {
						    
						    tempWall = new gameObject(objectBouncingWallDown, x, y);
						    tempWall.objectGravity = this.gravity;
						    gameObjects.push(tempWall);
						    
						}
						
					}
					
					function placeRandomCollectableAt(x, y) {
						
						var chance = getRandomNumberInRange(1000);
						
						if (chance <= 50) {
						    
						    gameObjects.push(new gameObject(objectLifeToken, x, y));
						    
						} else if (chance <= 100) {
							
							gameObjects.push(new gameObject(objectInvincibilityFlower, x, y));
							
						} else if (chance <= 200) {
							
							if (Math.random() >= 0.5) {
								
								gameObjects.push(new gameObject(objectFastArrow, x, y));
								
							} else {
								
								gameObjects.push(new gameObject(objectSlowArrow, x, y));
								
							}
							
						} else if (chance <= 400) {
							
							if (Math.random() >= 0.5) {
								
								gameObjects.push(new gameObject(objectFeather, x, y));
								
							} else {
								
								gameObjects.push(new gameObject(objectBallAndChain, x, y));
								
							}
							
						} else if (chance <= 600) {
							
							if (Math.random() >= 0.5) {
								
								gameObjects.push(new gameObject(objectWaterBucket, x, y));
								
							} else {
								
								gameObjects.push(new gameObject(objectSlimeBucket, x, y));
								
							}
							
						} else {
							
							gameObjects.push(new gameObject(objectCoin, x, y));
							
						}
						
					}
					
					function loopedImage(source, updateRate, reversed) {
						
						this.image1 = new Image();
						this.image2 = new Image();
						this.image1.src = source;
						this.image2.src = source;
						
						this.currentOffset = 0;
						
						this.update = function() {
							
							this.currentOffset += Math.abs(objectMovementRate + updateRate);
							if (this.currentOffset >= this.image1.width) {
								
								this.currentOffset = 0;
								
							}
							
						}
						
						this.draw = function(x, y) {
							
							if (reversed) {
								
								context.drawImage(this.image1, x - this.currentOffset, y);
								context.drawImage(this.image2, x - this.currentOffset + this.image1.width, y);
							
							} else {
								
								context.drawImage(this.image1, x + this.currentOffset, y);
								context.drawImage(this.image2, x + this.currentOffset - this.image1.width, y);
								
							}
							
						}
						
					}
					
					function playerStat(name, level) {
						
						this.name = name;
						this.level = level;
						this.hasBeenEffected = false;
						this.markedForRemoval = false;
						
						this.update = function() {
							
							if (!this.hasBeenEffected) {
								
								if (this.name === "WATER_BUCKET") {
									
									if (playerBounceRate - 0.1 > 0) {
										
										playerBounceRate -= 0.1;
										playerBounceLevel++;
										
									} else {
										
										score++;
										
									}
									
								}
								
								if (this.name === "SLIME_BUCKET") {
									
									if (playerBounceRate + 0.1 < 0.9) {
										
										playerBounceRate += 0.1;
										playerBounceLevel--;
										
									} else {
										
										score++;
										
									}
									
								}
								
								if (this.name === "FEATHER") {
									
									if (gravity - 0.005 > 0) {
										
										gravity -= 0.005;
										playerGravityLevel++;
										
									} else {
										
										score++;
										
									}
									
								}
								
								if (this.name === "BALL_AND_CHAIN") {
									
									if (gravity + 0.005 < 0.03) {
										
										gravity += 0.005;
										playerGravityLevel--;
										
									} else {
										
										score++;
										
									}
									
								}
								
								if (this.name === "FAST_ARROW") {
									
									if ((objectMovementRate + 1) + 0.1 < 2) {
										
										objectMovementRate += 0.1;
										playerSpeedLevel++;
										
									} else {
										
										score++;
										
									}
									
								}
								
								if (this.name === "SLOW_ARROW") {
									
									if ((objectMovementRate + 1) - 0.1 > 0.5) {
										
										objectMovementRate -= 0.1;
										playerSpeedLevel--;
										
									} else {
										
										score++;
										
									}
									
								}
								
								if (this.name === "INVINCIBILITY_FLOWER") {
									
									playerInvincibilityTime = 6000;
									
								}
								
								if (this.name === "LIFE_TOKEN") {
								    
								    playerLives++;
								    
								}
								
								this.hasBeenEffected = true;
								
							}
							
						}
						
					}
					
					//Nothing to see here ;)
					
					function boss(name) {
					    
					    this.name = name;
					    
					    this.update = function() {
					        
					        if (this.name === "CHICKEN_BOOS") {
					            
					        }
					        
					    }
					    
					    this.draw = function() {
					        
					        
					        
					    }
					    
					}
					
					function objectType(name, source, width, height, collisionX, collisionY, collisionWidth, collisionHeight) {
						
						this.name = name;
						
						this.image = new Image();
						this.image.src = source;
						
						this.width = width;
						this.height = height;
						this.name = name;
						this.collisionX = collisionX;
						this.collisionY = collisionY;
						this.collisionWidth = collisionWidth;
						this.collisionHeight = collisionHeight;
						
						this.draw = function(x, y) {
							
							context.drawImage(this.image, x, y, this.width, this.height);
							
						}
						
					}
					
					function gameObject(type, x, y) {
						
						this.x = x - type.collisionX;
						this.y = y - type.collisionY;
						this.imageX = x;
						this.imageY = y;
						this.width = type.collisionWidth;
						this.height = type.collisionHeight;
						this.type = type;
						
						this.collisionBox = new collisionRectangle(this.x, this.y, this.width, this.height);
						
						this.avoided = false;
						
						this.markedForRemoval = false;
						
						if (this.type.name === "BOUNCING_WALL_UP" || this.type.name === "BOUNCING_WALL_DOWN") {
						    
						    this.objectGravity = 0.02;
						    this.currentVelocity = 0;
						    
						}
						
						this.draw = function(offset) {
							
							type.draw(this.imageX - offset, this.imageY);
							
							if (developerMode) {
								
								context.beginPath();
								context.lineWidth = "1";
								context.strokeStyle = "red";
								context.rect(this.x - offset, this.y, this.width, this.height);
								context.stroke();
								
							}
							
						}
						
						this.update = function(offset) {
							
							this.collisionBox = new collisionRectangle(this.x - offset, this.y, this.width, this.height);
							
							if (this.type.name === "BOUNCING_WALL_UP") {
							    
							    this.currentVelocity -= this.objectGravity;
							    this.y += this.currentVelocity;
							    this.imageY += this.currentVelocity;
							    
							    if (this.y <= 0) {
							        
							        this.y = 0;
							        this.imageY = 0;
							        this.currentVelocity *= -1;
							        
							    }
							    
							}
							
							if (this.type.name === "BOUNCING_WALL_DOWN") {
							    
							    this.currentVelocity += this.objectGravity;
							    this.y += this.currentVelocity;
							    this.imageY += this.currentVelocity;
							    
							    if (this.y >= canvas.height - this.height) {
							        
							        this.y = canvas.height - this.height;
							        this.imageY = canvas.height - this.height;
							        this.currentVelocity *= -1;
							        
							    }
							    
							}
							
							if (playerX + 40 > this.x - offset && playerX < (this.x + this.width) - offset) {
								
								if (!this.avoided || this.markedForRemoval) {
									
									this.avoided = true;
									if (this.type.name === "SCORE_FLAG") {
										
										score++;
										
									} else if (this.type.name === "MOVEMENT_RESET_FLAG") {
										
										moveObjectsSlowly = false;
										
									}
									
								}
								
							}
							
							if (doRectanglesCollide(playerCollisionBox, this.collisionBox)) {
								
								if (this.type.name === "WALL" && playerInvincibilityTime <= 0) {
									
									if (playerLives === 0) {
									    
									    currentGameState = "GAME_OVER";
									
									} else {
									    
									    playerLives--;
									    playerInvincibilityTime = 250;
									    
									}
									
								} else if (this.type.name === "DIRECTIONAL_FILTER_UP" && playerInvincibilityTime <= 0) {
									
									if (!(playerRotation <= 360 && playerRotation >= 270)) {
										
										if (playerLives === 0) {
							    		    
							    		    currentGameState = "GAME_OVER";
						    			
						    			} else {
						    			    
						    			    playerLives--;
						    			    playerInvincibilityTime = 250;
									        
						    			}
						    			
									}
									
								} else if (this.type.name === "DIRECTIONAL_FILTER_DOWN" && playerInvincibilityTime <= 0) {
									
									if (!(playerRotation >= 180 && playerRotation <= 270)) {
										
										if (playerLives === 0) {
							    		    
							    		    currentGameState = "GAME_OVER";
						    			
						    			} else {
						    			    
						    			    playerLives--;
						    			    playerInvincibilityTime = 250;
									        
						    			}
										
									}
									
								} else if (this.type.name === "BOUNCING_WALL_UP" && playerInvincibilityTime <= 0) {
								    
								    if (playerLives === 0) {
									    
									    currentGameState = "GAME_OVER";
									
									} else {
									    
									    playerLives--;
									    playerInvincibilityTime = 250;
									    
									}
									
								} else if (this.type.name === "BOUNCING_WALL_DOWN" && playerInvincibilityTime <= 0) {
								    
								    if (playerLives === 0) {
									    
									    currentGameState = "GAME_OVER";
									
									} else {
									    
									    playerLives--;
									    playerInvincibilityTime = 250;
									    
									}
									
								} else if (this.type.name === "COIN") {
									
									score++;
									this.markedForRemoval = true;
									
								} else if (this.type.name === "WATER_BUCKET") {
									
									playerStats.push(new playerStat(this.type.name, 1));
									this.markedForRemoval = true;
									
								} else if (this.type.name === "SLIME_BUCKET") {
									
									playerStats.push(new playerStat(this.type.name, 1));
									this.markedForRemoval = true;
									
								} else if (this.type.name === "FEATHER") {
									
									playerStats.push(new playerStat(this.type.name, 1));
									this.markedForRemoval = true;
									
								} else if (this.type.name === "BALL_AND_CHAIN") {
									
									playerStats.push(new playerStat(this.type.name, 1));
									this.markedForRemoval = true;
									
								} else if (this.type.name === "FAST_ARROW") {
									
									playerStats.push(new playerStat(this.type.name, 1));
									this.markedForRemoval = true;
									
								} else if (this.type.name === "SLOW_ARROW") {
									
									playerStats.push(new playerStat(this.type.name, 1));
									this.markedForRemoval = true;
									
								} else if (this.type.name === "INVINCIBILITY_FLOWER") {
									
									playerStats.push(new playerStat(this.type.name, 1));
									this.markedForRemoval = true;
									
								} else if (this.type.name === "LIFE_TOKEN") {
									
									playerStats.push(new playerStat(this.type.name, 1));
									this.markedForRemoval = true;
									
								}
								
							}
							
						}
						
					}
					
					function saveHighscore(score) {
						
						if (typeof(Storage) !== "undefined") {
							
							if (easyMode) {
								
								if (!localStorage.easyModeScore) {
									
									localStorage.easyModeScore = 0;
									
								}
								
								if (localStorage.easyModeScore < score) {
									
									localStorage.easyModeScore = score;
									
								}
								
							} else if (hardMode) {
								
								if (!localStorage.hardModeScore) {
									
									localStorage.hardModeScore = 0;
									
								}
								
								if (localStorage.hardModeScore < score) {
									
									localStorage.hardModeScore = score;
									
								}
								
							} else {
								
								if (!localStorage.normalModeScore) {
									
									localStorage.normalModeScore = 0;
									
								}
								
								if (localStorage.normalModeScore < score) {
									
									localStorage.normalModeScore = score;
									
								}
								
							}
							
						}
						
					}
					
					function getRandomNumberInRange(max) {
						
						return Math.floor((Math.random() * max) % max);
						
					}
					
					function collisionRectangle(minX, minY, maxX, maxY) {
						
						this.minX = minX;
						this.minY = minY;
						this.maxX = maxX;
						this.maxY = maxY;
						
					}
					
					function doRectanglesCollide(rectangle1, rectangle2) {
						
						if (rectangle1.minX + rectangle1.maxX > rectangle2.minX && rectangle1.minX < rectangle2.minX + rectangle2.maxX) {
								
							if (rectangle1.minY + rectangle1.maxY > rectangle2.minY && rectangle1.minY < rectangle2.minY + rectangle2.maxY) {
							
								return true;
								
							} else {
								
								return false;
								
							}
						} else {
							
							return false;
							
						}
						
					}
					
			</script>
			<br>
			<h3 id="easyModeScore">Easy Mode Highscore : 0</h3>
			<h3 id="normalModeScore">Normal Mode Highscore : 0</h3>
			<h3 id="hardModeScore">Hard Mode Highscore : 0</h3>
			<br>
			<br>
			<h2>How to play :</h2>
			<p>Just... play?</p>
			<br>
			<br>
			<br>
			<br>
			<br>
			<br>
			<h2>Update Logs : </h2>
			
			<h3>???</h3>
			<h3>2.4.0</h3>
			<h4>'Improve the game v1'</h4>
			
			<h2>vv Current Version vv</h2>
			
			<h3>3.13</h3>
			<p>Added highscore save system</p>
			<p>Fixed update log organization</p>
			
			<h3>3.12</h3>
			<p>Added toggleable 'hard-mode'</p>
			<h3>3.11</h3>
			<p>Added fast arrow collectable</p>
			<p>Added slow arrow collectable</p>
			<h3>3.10</h3>
			<p>- Added the ability to press [ENTER] on menu and game over screen to continue</p>
			<p>- Added feather collectable</p>
			<p>- Added ball and chain collectable</p>
			<h3>3.9</h3>
			<p>- Added life token collectable</p>
			<h3>3.8</h3>
			<p>- Added ability bar</p>
			<p>- Reworked collectable spawing system</p>
			<h3>3.7</h3>
			<p>- Added pause feature</p>
			<h3>3.6</h3>
			<p>- Added bouncing wall obstacle</p>
			<h3>3.5</h3>
			<p>- Reduced image render lag</p>
			<h3>3.4</h3>
			<p>- Changed player rotation rate for hard mode</p>
			<p>- Added new texture for player when invincibility is enabled</p>
			<h3>3.3</h3>
			<p>- Reworked randomization system</p>
			<p>- Added new obstacle spawn layouts</p>
			<h3>3.2</h3>
			<p>- Changed texture and collision box for filter wall obstacle</p>
			<h3>3.1</h3>
			<p>- Added invincibility flower collectable</p>
			<h3>3.0</h3>
			<p>- Changed all collectable textures</p>
			<p>- Changed layer rendering order</p>
			<h3>2.3.0</h3>
			<h4>'New look v1'</h4>
			
			<h3>2.2</h3>
			<p>- Reworked collision system</p>
			<h3>2.1</h3>
			<p>- Added toggleable 'easy-mode'</p>
			<p>- Added toggleable 'developer-mode'</p>
			<p>- Added new 'slow moving object' system</p>
			<h3>2.0</h3>
			<p>- Added water bucket collectable</p>
			<p>- Added slime bucket collectable</p>
			<p>- Added filter wall obstacle</p>
			<h3>2.2.0</h3>
			<h4>'More Gameplay v1'</h4>
			
			<h3>1.3</h3>
			<p>- Fixed physics</p>
			<h3>1.2</h3>
			<p>- Added game-over screen</p>
			<h3>1.1</h3>
			<p>- Added score system</p>
			<p>- Added coin collectable</p>
			<h3 onclick="updateReference()">1.0</h3>
			<p>- Added wall obstacle</p>
			<h3>2.1.0</h3>
			<h4>'Base Gameplay'</h4>
			
			<h3>0.0</h3>
			<p>- Made, ya know, the game</p>
			
			<h3>2.0.0</h3>
			<h4>'Hello World!'</h4>
			
		</center>
	</body>
</html>